{"version":3,"file":"component---src-pages-climate-change-graphs-relative-changes-js-bd7878ecb59088b02892.js","mappings":"0HAAA,SAASA,EAAaC,GACpB,IAAKA,EAASC,GAAI,MAAM,IAAIC,MAAMF,EAASG,OAAS,IAAMH,EAASI,YACnE,OAAOJ,EAASK,MAClB,CAEe,WAASC,EAAOC,GAC7B,OAAOC,MAAMF,EAAOC,GAAME,KAAKV,EACjC,C,8ICEA,MAAMW,EAAQC,EAAAA,GAAOC,IAAGC,WAAA,CAAAC,YAAA,yBAAAC,YAAA,eAAVJ,CAAU,iHASlBK,EAASL,EAAAA,GAAOC,IAAGC,WAAA,CAAAC,YAAA,0BAAAC,YAAA,eAAVJ,CAAU,sBAInBM,EAAaN,EAAAA,GAAOC,IAAGC,WAAA,CAAAC,YAAA,8BAAAC,YAAA,eAAVJ,CAAU,uBAIvBO,EAAmBP,EAAAA,GAAOC,IAAGC,WAAA,CAAAC,YAAA,oCAAAC,YAAA,eAAVJ,CAAU,MA0MnC,UAvMmBQ,KACjB,MAAM,EAACC,EAAO,EAACC,IAAgBC,EAAAA,EAAAA,WAASC,EAAAA,EAAAA,kBAsJxC,OAJAC,EAAAA,EAAAA,YAAU,MA/IRnB,EAAAA,EAAAA,GAAK,iCAAiCI,MAAMgB,IAC1C,MAAMC,EAAUD,EAAIE,MAAM,MACvBC,QAAO,CAACC,EAAGC,IAAMA,GAAK,GAAKA,EAAI,MAE/BF,QAAO,CAACG,EAAGD,IAAY,IAANA,GAA+B,SAApBC,EAAEJ,MAAM,KAAK,KACtCK,EAASN,EAAQ,GAAGC,MAAM,KAC7BC,QAAO,CAACC,EAAGI,IAAMA,GAAK,KAEnBC,EAAO,CAAC,EACdR,EAAQS,SAAQ,CAACJ,EAAGD,KAClB,GAAU,IAANA,EAAW,OACf,MAAMM,EAAML,EAAEJ,MAAM,KACpBK,EAAOG,SAAQ,CAACE,EAAGJ,KACP,IAANA,SACYK,IAAZJ,EAAKG,KAAoBH,EAAKG,GAAK,GACvCH,EAAKG,KAAQD,EAAIH,GAAGM,QAAQ,IAAK,KAAK,GACtC,IAGJ,MAAMC,EAAO,CACX,CACEC,KAAM,yBACNC,MACAR,EAAK,WACHA,EAAKS,UACLT,EAAKU,KAET,CAAEH,KAAM,WAAYC,MAAOR,EAAK,oBAChC,CAAEO,KAAM,qBAAsBC,MAAOR,EAAKW,SAC1C,CAAEJ,KAAM,gBAAiBC,MAAOR,EAAKY,OACrC,CACEL,KAAM,mBACNC,MACAR,EAAKa,IACHb,EAAK,cACLA,EAAK,eACLA,EAAK,cACLA,EAAK,eAIX,IAAIc,EAAS,CAAC,GACdR,EAAKL,SAAQ,CAACN,EAAGC,KACL,IAANA,IAEJA,EAAIU,EAAKS,OAASnB,EAAI,EACtBkB,EAAOE,KACLF,EAAOA,EAAOC,OAAS,IACpBT,EAAKV,EAAI,GAAGY,MAAQ,EAAIF,EAAKV,EAAI,GAAGY,MAAQ,IAC5CF,EAAKV,GAAGY,MAAQ,GAAKF,EAAKV,GAAGY,MAAQ,IACzC,IAEHM,EAAOE,KAAK,GAAIV,EAAKW,QAAQ,CAAEV,KAAM,uBAAwBC,MAAO,MACpEM,EAASA,EAAOI,UAEhB,MAAMC,GAAY9B,EAAAA,EAAAA,iBAElB8B,EAAUC,KAAKC,KAAO,IAEtBF,EAAUG,MAAMf,KAAO,0BACvBY,EAAUG,MAAMC,aAAe,SAC/BJ,EAAUG,MAAME,QAAU,GAC1BL,EAAUC,KAAKK,QAAU,GAEzBN,EAAUG,MAAMI,KAAO,QACvBP,EAAUQ,MAAMrB,KAAOA,EAAKsB,KAAI/B,GAAKA,EAAEU,OAEvCY,EAAUU,QAAQC,UAAaC,IAC7B,MAAMC,EAAKD,EACRrC,QAAOG,GAAsB,WAAjBA,EAAEoC,aACdvC,QAAOG,GAAgB,MAAXA,EAAES,OAAc,GAC/B,IAAK0B,EAAG1B,KAAQ,OAChB,MAAME,EAAQwB,EAAG1B,KAEX4B,GADOF,EAAGzB,KACoB,QAAlByB,EAAGC,YAErB,MAAO,GAAGC,EAAY,UAAY,kBAAkBA,EAAY,GAAK,MAAM1B,mBAAuB,EAGpGW,EAAUgB,OAAS,CAEjB,CACE5B,KAAM,SACNmB,KAAM,MACNU,MAAO,SACP9B,KAAMQ,EACNuB,UAAW,CACTC,OAAQ,CACNC,eAAgB,gBAChBC,MAAO,iBAETC,SAAU,CACRF,eAAgB,gBAChBC,MAAO,mBAIb,CACEjC,KAAM,MACNmB,KAAM,MACNU,MAAO,SACP9B,KAAMA,EACHsB,KAAI/B,GAAMA,EAAEW,MAAQ,EAAI,IAAMX,EAAEW,QACnCkC,MAAO,CACLJ,OAAQ,CACNK,MAAM,EACNC,SAAU,WAIhB,CACErC,KAAM,MACNmB,KAAM,MACNU,MAAO,SACPS,OAAQ,EACRvC,KAAMA,EACHsB,KAAI/B,GAAMA,EAAEW,OAAS,EAAI,KAAOX,EAAEW,QACrCkC,MAAO,CACLJ,OAAQ,CACNK,MAAM,EACNC,SAAU,OACVd,UAAW,UAIjB,CACEvB,KAAM,MACNmB,KAAM,MACNU,MAAO,SACPS,OAAQ,EACRvC,KAAMA,EAAKsB,KAAI,CAACjC,EAAGC,IAAa,IAANA,EAAUkB,EAAO,GAAK,MAChD4B,MAAO,CACLJ,OAAQ,CACNK,MAAM,EACNC,SAAU,YAKlBzD,EAAagC,EAAU,GAKf,GACT,IAGD2B,EAAAA,cAACtE,EAAK,KACJsE,EAAAA,cAAC/D,EAAU,KAAC,sBACU,IACpB+D,EAAAA,cAACC,EAAAA,GAAI,CACHC,SAAO,EACPC,KAAK,kDACLC,OAAO,SACPC,IAAI,uBACL,qBAGA,IAAI,4BAEPL,EAAAA,cAAC9D,EAAgB,KAAC,SAEhB8D,EAAAA,cAAA,WAAK,MAEPA,EAAAA,cAACM,EAAAA,EAAY,CACXlE,OAAQA,EACRmE,UAAQ,IAEVP,EAAAA,cAAChE,EAAM,KAAC,2DAEL,IACDgE,EAAAA,cAACC,EAAAA,GAAI,CACHC,SAAO,EACPC,KAAK,8EACLC,OAAO,SACPC,IAAI,uBACL,2BAGA,IAAI,IACLL,EAAAA,cAACC,EAAAA,GAAI,CACHC,SAAO,EACPC,KAAK,qEACLC,OAAO,SACPC,IAAI,uBACL,QAEM,KAGH,C","sources":["webpack://personal-website/./node_modules/d3-fetch/src/text.js","webpack://personal-website/./src/pages/climate-change/graphs/relativeChanges.js"],"sourcesContent":["function responseText(response) {\n  if (!response.ok) throw new Error(response.status + \" \" + response.statusText);\n  return response.text();\n}\n\nexport default function(input, init) {\n  return fetch(input, init).then(responseText);\n}\n","import React, { useState, useEffect } from 'react';\nimport ReactEcharts from 'echarts-for-react';\nimport * as echarts from 'echarts';\nimport { text } from 'd3-fetch';\nimport styled from 'styled-components';\n\nimport { Link } from 'gatsby';\nimport { initialOption, parseGiss, initialDataZoom } from './common';\n\nconst Graph = styled.div`\n   width: 100%;\n    box-sizing: border-box;\n    margin-right: auto;\n    margin-left: auto;\n    padding-top: 1.5em;\n    padding-bottom: 1.5em;\n`;\n\nconst Source = styled.div`\n  font-size: small;\n`;\n\nconst GraphTitle = styled.div`\n  font-weight: bold;\n`;\n\nconst GraphDescription = styled.div`\n`;\n\nconst GlobalTemp = () => {\n  const [option, updateOption] = useState(initialOption());\n\n  const loadData = () => {\n    text('/data/IPCC_WG1AR5_All_1_2.csv').then((obj) => {\n      const rawData = obj.split('\\n')\n        .filter((_, i) => i >= 7 && i < 270)\n        // .filter(function(_, i) { return i == 0 || i >= 100 + 1 }) // start 100y after\n        .filter((d, i) => i === 0 || d.split(';')[0] === '2011');\n      const header = rawData[0].split(';')\n        .filter((_, j) => j <= 11);\n      // Sum by column\n      const sums = {};\n      rawData.forEach((d, i) => {\n        if (i === 0) { return; } // skip header\n        const row = d.split(';');\n        header.forEach((h, j) => {\n          if (j === 0) { return; } // skip year\n          if (sums[h] === undefined) { sums[h] = 0; }\n          sums[h] += +(row[j].replace(',', '.'));\n        });\n      });\n\n      const data = [\n        {\n          name: 'Other man-made changes',\n          value:\n          sums['BC Snow']\n          + sums.Contrails\n          + sums.LUC,\n        },\n        { name: 'Aerosols', value: sums['Aerosol (Total)'] },\n        { name: 'Volcano erruptions', value: sums.Volcano },\n        { name: 'Solar changes', value: sums.Solar },\n        {\n          name: 'Greenhouse gases',\n          value:\n          sums.CO2\n          + sums['GHG OTher*']\n          + sums['H2O (Strat)']\n          + sums['O3 (Strat)']\n          + sums['O3 (Trop)'],\n        },\n      ];\n\n      let cumSum = [0];\n      data.forEach((_, i) => {\n        if (i === 0) { return; }\n        // eslint-disable-next-line no-param-reassign\n        i = data.length - i - 1; // reverse\n        cumSum.push(\n          cumSum[cumSum.length - 1]\n          + (data[i + 1].value > 0 ? data[i + 1].value : 0)\n          - (data[i].value < 0 ? -data[i].value : 0),\n        );\n      });\n      cumSum.push(0); data.unshift({ name: 'Net observed warming', value: '-' });\n      cumSum = cumSum.reverse();\n\n      const newOption = initialOption();\n\n      newOption.grid.left = 150;\n\n      newOption.xAxis.name = 'Warming increase (W/mÂ²)';\n      newOption.xAxis.nameLocation = 'middle';\n      newOption.xAxis.nameGap = 30;\n      newOption.grid.bottom += 30;\n\n      newOption.xAxis.type = 'value';\n      newOption.yAxis.data = data.map(d => d.name);\n\n      newOption.tooltip.formatter = (e) => {\n        const e0 = e\n          .filter(d => d.seriesName !== 'offset')\n          .filter(d => d.data !== '-')[0];\n        if (!e0.data) { return; }\n        const value = e0.data;\n        const name = e0.name;\n        const isWarming = e0.seriesName === 'pos';\n        // eslint-disable-next-line consistent-return\n        return `${isWarming ? 'Heating' : 'Cooling'} with ${isWarming ? '' : '-'}${value} W/m<sup>2</sup>`;\n      };\n\n      newOption.series = [\n        // transparent bars the add the offsets\n        {\n          name: 'offset',\n          type: 'bar',\n          stack: 'common',\n          data: cumSum,\n          itemStyle: {\n            normal: {\n              barBorderColor: 'rgba(0,0,0,0)',\n              color: 'rgba(0,0,0,0)',\n            },\n            emphasis: {\n              barBorderColor: 'rgba(0,0,0,0)',\n              color: 'rgba(0,0,0,0)',\n            },\n          },\n        },\n        {\n          name: 'pos',\n          type: 'bar',\n          stack: 'common',\n          data: data\n            .map(d => (d.value < 0 ? '-' : d.value)),\n          label: {\n            normal: {\n              show: true,\n              position: 'right',\n            },\n          },\n        },\n        {\n          name: 'neg',\n          type: 'bar',\n          stack: 'common',\n          barGap: 0,\n          data: data\n            .map(d => (d.value >= 0 ? '-' : -d.value)),\n          label: {\n            normal: {\n              show: true,\n              position: 'left',\n              formatter: '-{c}',\n            },\n          },\n        },\n        {\n          name: 'net',\n          type: 'bar',\n          stack: 'common',\n          barGap: 0,\n          data: data.map((_, i) => (i === 0 ? cumSum[1] : '-')),\n          label: {\n            normal: {\n              show: true,\n              position: 'right',\n            },\n          },\n        },\n      ];\n      updateOption(newOption);\n    });\n  };\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  return (\n    <Graph>\n      <GraphTitle>\n        Relative changes in{' '}\n        <Link\n          outward\n          href=\"https://en.wikipedia.org/wiki/Radiative_forcing\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          radiative forcing\n        </Link>\n        {' '}in 2011 compared to 1750\n      </GraphTitle>\n      <GraphDescription>\n        in W/m\n        <sup>2</sup>\n      </GraphDescription>\n      <ReactEcharts\n        option={option}\n        notMerge\n      />\n      <Source>\n        Source: Intergovernmental Panel on Climate Change (IPCC)\n        {' '}\n        <Link\n          outward\n          href=\"http://www.ipcc.ch/pdf/assessment-report/ar5/wg1/WG1AR5_Chapter08_FINAL.pdf\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          WG1 AR5, Fig. 8.15 p697\n        </Link>\n        {' '}(\n        <Link\n          outward\n          href=\"http://www.ipcc.ch/report/ar5/wg1/docs/WG1AR5_AIISM_Datafiles.xlsx\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          data\n        </Link>\n        )\n      </Source>\n    </Graph>\n  );\n};\n\nexport default GlobalTemp;\n"],"names":["responseText","response","ok","Error","status","statusText","text","input","init","fetch","then","Graph","styled","div","withConfig","displayName","componentId","Source","GraphTitle","GraphDescription","GlobalTemp","option","updateOption","useState","initialOption","useEffect","obj","rawData","split","filter","_","i","d","header","j","sums","forEach","row","h","undefined","replace","data","name","value","Contrails","LUC","Volcano","Solar","CO2","cumSum","length","push","unshift","reverse","newOption","grid","left","xAxis","nameLocation","nameGap","bottom","type","yAxis","map","tooltip","formatter","e","e0","seriesName","isWarming","series","stack","itemStyle","normal","barBorderColor","color","emphasis","label","show","position","barGap","React","Link","outward","href","target","rel","ReactEcharts","notMerge"],"sourceRoot":""}