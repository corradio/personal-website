{"version":3,"sources":["webpack:///./src/components/interactivegrid.js","webpack:///./src/pages/projects.js","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js","webpack:///./node_modules/core-js/internals/object-keys.js","webpack:///./node_modules/core-js/internals/is-array.js","webpack:///./src/videos/north.mp4","webpack:///./node_modules/core-js/internals/classof.js","webpack:///./node_modules/core-js/internals/function-bind-context.js","webpack:///./node_modules/core-js/internals/to-string-tag-support.js","webpack:///./node_modules/core-js/modules/es.array.flat.js","webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./node_modules/core-js/internals/array-species-constructor.js","webpack:///./node_modules/core-js/internals/delete-property-or-throw.js","webpack:///./node_modules/core-js/internals/html.js","webpack:///./node_modules/core-js/internals/object-define-properties.js","webpack:///./node_modules/core-js/internals/does-not-exceed-safe-integer.js","webpack:///./node_modules/core-js/modules/es.array.unscopables.flat.js","webpack:///./node_modules/core-js/internals/add-to-unscopables.js","webpack:///./node_modules/core-js/internals/function-uncurry-this-clause.js","webpack:///./node_modules/core-js/internals/array-slice-simple.js","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./node_modules/core-js/internals/to-string.js","webpack:///./node_modules/core-js/internals/array-species-create.js","webpack:///./node_modules/core-js/internals/is-constructor.js","webpack:///./node_modules/core-js/internals/object-create.js","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/core-js/internals/flatten-into-array.js","webpack:///./node_modules/core-js/internals/array-sort.js"],"names":["DEFAULT_CONFIG","generators","g2","type","energy","gridKey","g3","g5","consumers","c1","emissionFactor","originMix","c2","purchases","c3","modeColor","solar","wind","hydro","battery","biomass","geothermal","nuclear","gas","coal","oil","unknown","configByGrid","config","byGrid","Object","entries","forEach","_ref","k","v","_ref2","kk","vv","averageMix","totalEnergy","byGeneration","_ref3","generatorKey","generator","keys","loadAveragedMixes","arr","mixAccessor","loadAccessor","sumByKey","totalLoad","map","reduce","a","b","d","_ref5","generatorHasSoldContract","g","contractualKey","purchasers","attributionRules","locationBased","attributedConfig","JSON","parse","stringify","_ref4","gridConfig","values","filter","consumer","marketBased","allocatedConsumers","_consumer$originMix","push","key","surplusMixForGrids","_ref6","grid","gridLoad","gridLoadAfterContract","c","consumerKey","_ref7","_ref8","flat","remainingGenerators","residualMix","hasResidualMix","join","includes","surplusLoad","surplusMix","_ref9","_ref10","_ref11","load","mix","EnergyBlock","_ref12","style","React","createElement","assign","width","height","backgroundColor","Generator","_ref13","display","flexDirection","justifyContent","alignItems","flexWrap","marginBottom","Array","from","_","i","margin","Consumer","_ref14","byMix","_ref15","Fragment","slice","sort","_ref16","marginRight","Math","round","GridGenerators","_ref17","generatorArray","_ref18","nextGenerator","prevGenerator","isConnectedToNext","isConnectedToPrev","extraStyles","borderBottom","borderColor","borderImage","flex","GridConsumers","_ref19","totalGenerators","length","_ref20","gridGenerators","gridConsumers","flexBasis","alignSelf","borderTop","AnnotationLayer","_ref21","attributionRule","allGeneratorKeys","allGridKeys","gridHorizontalRatios","purchaseLabels","purchaseLineSpecs","_consumer$k","fromKey","_ref22","toKey","generatorInterval","x1","indexOf","consumerGridKey","gridIndex","consumerKeysInGrid","indexWithinGrid","consumerInterval","x2","abs","y1","y2","label","xmlns","position","id","markerWidth","markerHeight","refX","refY","orient","points","_ref23","stroke","strokeDasharray","markerEnd","x","y","textAnchor","strokeWidth","_ref24","_Object$assign","attributionRuleKey","_useState","useState","seller","setSeller","updatedConfig","_ref25","attribute","marginLeft","onChange","e","target","value","selected","data","location","Layout","SEO","title","marginTop","rhythm","href","src","alt","Grid","padding","controls","NorthVideo","UA","module","exports","test","internalObjectKeys","enumBugKeys","O","classof","isArray","argument","TO_STRING_TAG_SUPPORT","isCallable","classofRaw","TO_STRING_TAG","wellKnownSymbol","$Object","CORRECT_ARGUMENTS","arguments","it","tag","result","undefined","error","tryGet","callee","uncurryThis","aCallable","NATIVE_BIND","bind","fn","that","apply","String","$","flattenIntoArray","toObject","lengthOfArrayLike","toIntegerOrInfinity","arraySpeciesCreate","proto","depthArg","this","sourceLen","A","firefox","match","isConstructor","isObject","SPECIES","$Array","originalArray","C","constructor","prototype","tryToString","$TypeError","TypeError","P","getBuiltIn","DESCRIPTORS","V8_PROTOTYPE_DEFINE_BUG","definePropertyModule","anObject","toIndexedObject","objectKeys","f","defineProperties","Properties","props","index","addToUnscopables","create","defineProperty","UNSCOPABLES","ArrayPrototype","configurable","toAbsoluteIndex","createProperty","max","start","end","fin","n","deletePropertyOrThrow","toString","fails","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","charAt","forced","comparefn","array","itemsLength","items","arrayLength","getSortCompare","webkit","$String","arraySpeciesConstructor","inspectSource","noop","empty","construct","constructorRegExp","exec","INCORRECT_TO_STRING","isConstructorModern","isConstructorLegacy","sham","called","call","activeXDocument","definePropertiesModule","hiddenKeys","html","documentCreateElement","sharedKey","IE_PROTO","EmptyConstructor","scriptTag","content","LT","NullProtoObjectViaActiveX","write","close","temp","parentWindow","NullProtoObject","ActiveXObject","iframeDocument","iframe","document","domain","appendChild","contentWindow","open","F","toPropertyKey","createPropertyDescriptor","object","propertyKey","doesNotExceedSafeInteger","original","source","depth","mapper","thisArg","element","elementLen","targetIndex","sourceIndex","mapFn","arraySlice","floor","mergeSort","middle","insertionSort","merge","j","left","right","llength","rlength","lindex","rindex"],"mappings":"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","file":"component---src-pages-projects-js-a2aa4f640b8a17f3c259.js","sourcesContent":["import React, { useState } from 'react';\n\nconst GRID_CONNECTION_HEIGHT = 100;\n\nexport const DEFAULT_CONFIG = {\n  generators: {\n    // g1: { type: 'nuclear', energy: 2, gridKey: 'A' },\n    g2: { type: 'coal', energy: 1, gridKey: 'A' },\n    g3: { type: 'wind', energy: 1, gridKey: 'A' },\n    // g4: { type: 'wind', energy: 1, gridKey: 'A' },\n    g5: { type: 'hydro', energy: 1, gridKey: 'B' },\n  },\n  consumers: {\n    c1: {\n      type: 'household',\n      gridKey: 'A',\n      emissionFactor: null,\n      originMix: null,\n      // purchases: ['g3'],\n    },\n    c2: {\n      type: 'factory',\n      gridKey: 'A',\n      purchases: ['g3'],\n      emissionFactor: null,\n      originMix: null,\n    },\n    c3: {\n      type: 'factory',\n      gridKey: 'B',\n      // purchases: ['g4'],\n      emissionFactor: null,\n      originMix: null,\n    },\n  },\n};\n\nconst modeColor = {\n  solar: '#f27406',\n  wind: '#74cdb9',\n  hydro: '#2772b2',\n  'hydro storage': '#0052cc',\n  battery: 'lightgray',\n  'battery storage': '#b76bcf',\n  biomass: '#166a57',\n  geothermal: 'yellow',\n  nuclear: '#AEB800',\n  gas: '#bb2f51',\n  coal: '#ac8c35',\n  oil: '#867d66',\n  unknown: '#ACACAC',\n};\n\nconst configByGrid = (config) => {\n  const byGrid = {};\n  Object.entries(config).forEach(([k, v]) => {\n    Object.entries(v).forEach(([kk, vv]) => {\n      const { gridKey } = vv;\n      if (!byGrid[gridKey]) {\n        byGrid[gridKey] = {};\n      }\n      if (!byGrid[gridKey][k]) {\n        byGrid[gridKey][k] = {};\n      }\n      if (!byGrid[gridKey][k][kk]) {\n        byGrid[gridKey][k][kk] = {};\n      }\n      byGrid[gridKey][k][kk] = vv;\n    });\n  });\n  return byGrid;\n};\n\nconst averageMix = (generators) => {\n  // Compute grid average mix\n  let totalEnergy = 0;\n  const byGeneration = {};\n  Object.entries(generators).forEach(([generatorKey, generator]) => {\n    totalEnergy += generator.energy;\n    byGeneration[generatorKey] = generator.energy;\n  });\n  // Compute ratios\n  Object.keys(byGeneration).forEach((k) => {\n    byGeneration[k] /= totalEnergy;\n  });\n  return byGeneration;\n};\n\nconst locationBased = (config) => {\n  // deep copy\n  const attributedConfig = JSON.parse(JSON.stringify(config));\n  // Group by grid\n  const byGrid = configByGrid(attributedConfig);\n  Object.entries(byGrid).forEach(([gridKey, gridConfig]) => {\n    const byGeneration = averageMix(gridConfig.generators);\n    // Assign\n    Object.values(attributedConfig.consumers)\n      .filter(consumer => consumer.gridKey === gridKey)\n      .forEach((consumer) => {\n        consumer.originMix = byGeneration;\n      });\n  });\n  return attributedConfig;\n};\n\nconst loadAveragedMixes = (arr, mixAccessor, loadAccessor) => {\n  const sumByKey = {};\n  const totalLoad = arr.map(loadAccessor).reduce((a, b) => a + b, 0);\n  arr.forEach(d =>\n    Object.entries(mixAccessor(d)).forEach(([k, v]) => {\n      sumByKey[k] = (sumByKey[k] || 0) + loadAccessor(d) * v;\n    }));\n  Object.keys(sumByKey).forEach((k) => {\n    sumByKey[k] /= totalLoad;\n  });\n  return sumByKey;\n};\n\nconst generatorHasSoldContract = (g, config, contractualKey) =>\n  !(!g.purchasers || (g.purchasers && !config.consumers[g.purchasers[0]][contractualKey]));\n\nconst marketBased = (config, contractualKey) => {\n  // deep copy\n  const attributedConfig = JSON.parse(JSON.stringify(config));\n  // Group by grid\n  const byGrid = configByGrid(attributedConfig);\n\n  // first allocate all contractual instruments\n  const allocatedConsumers = [];\n  Object.values(attributedConfig.consumers)\n    .filter(d => d[contractualKey])\n    .forEach((consumer) => {\n      allocatedConsumers.push(consumer.key);\n      // assume only a single purchase\n      consumer.originMix = { [consumer[contractualKey][0]]: 1 };\n    });\n\n  const surplusMixForGrids = Object.entries(byGrid).map(([key, grid]) => {\n    const gridLoad = Object.values(grid.generators)\n      .map(d => d.energy)\n      .reduce((a, b) => a + b, 0);\n    const purchasedGeneration = Object.values(grid.consumers)\n      .filter(c => c[contractualKey])\n      .map(c => attributedConfig.generators[c[contractualKey][0]].energy)\n      .reduce((a, b) => a + b, 0);\n    const soldGeneration = Object.values(grid.generators)\n      // only consider the purchasers who purchased the right instrument\n      .map(g =>\n        (g.purchasers || [])\n          .map(consumerKey => [g, consumerKey])\n          .filter(([_, consumerKey]) => attributedConfig.consumers[consumerKey][contractualKey])\n          .map(([g, _]) => g))\n      .flat()\n      .map(d => d.energy)\n      .reduce((a, b) => a + b, 0);\n    const gridLoadAfterContract = gridLoad\n      // add purchased generation\n      + purchasedGeneration\n      // subtract sold generation\n      - soldGeneration;\n\n    if (gridLoadAfterContract >= gridLoad) {\n      // all remaining consumers get the remaining grid mix\n      const remainingGenerators = {};\n      Object.values(grid.generators)\n        // only exclude the purchasers who purchased the right instrument\n        .filter(g => !generatorHasSoldContract(g, attributedConfig, contractualKey))\n        .forEach((g) => {\n          remainingGenerators[g.key] = g;\n        });\n      const residualMix = averageMix(remainingGenerators);\n      const hasResidualMix = Object.keys(grid.generators).join('') !== Object.keys(remainingGenerators).join('');\n      Object.values(grid.consumers)\n        .filter(consumer => !allocatedConsumers.includes(consumer.key))\n        .forEach((consumer) => {\n          consumer.hasResidualMix = hasResidualMix;\n          consumer.originMix = residualMix;\n        });\n      // return the surplus mix to be used by others\n      return {\n        key,\n        surplusLoad: gridLoadAfterContract - gridLoad,\n        residualMix,\n      };\n    } \n    return {\n      key,\n      surplusLoad: gridLoadAfterContract - gridLoad,\n    };\n  });\n\n  const surplusMix = loadAveragedMixes(\n    surplusMixForGrids.filter(d => d.surplusLoad > 0),\n    d => d.residualMix,\n    d => d.surplusLoad,\n  );\n  // For each grid, assign the surplus mix to the remaining load\n  surplusMixForGrids\n    .filter(d => d.surplusLoad < 0)\n    .forEach(({ key, surplusLoad }) => {\n      const grid = byGrid[key];\n      const remainingGenerators = {};\n      Object.entries(grid.generators)\n        // only exclude the purchasers who purchased the right instrument\n        .filter(([_, g]) => !generatorHasSoldContract(g, attributedConfig, contractualKey))\n        .forEach(([k, generator]) => {\n          remainingGenerators[k] = generator;\n        });\n      const gridLoad = Object.values(remainingGenerators)\n        .map(d => d.energy)\n        .reduce((a, b) => a + b, 0);\n      const residualMix = loadAveragedMixes(\n        [\n          { load: gridLoad, mix: averageMix(remainingGenerators) },\n          { load: -1 * surplusLoad, mix: surplusMix },\n        ],\n        d => d.mix,\n        d => d.load,\n      );\n      const hasResidualMix = Object.keys(grid.generators).join('') !== Object.keys(remainingGenerators).join('');\n      Object.values(grid.consumers)\n        .filter(consumer => !allocatedConsumers.includes(consumer.key))\n        .forEach((consumer) => {\n          consumer.hasResidualMix = hasResidualMix;\n          consumer.originMix = residualMix;\n        });\n    });\n\n  return attributedConfig;\n};\n\nconst attributionRules = {\n  locationBased,\n  marketBased: config => marketBased(config, 'purchases'),\n};\n\nconst EnergyBlock = ({ type, style }) => (\n  <div style={{\n    width: '6px', height: '6px', backgroundColor: modeColor[type], ...style, \n  }}\n  />\n);\n\nconst Generator = ({ generator }) => (\n  <div\n    key={generator.key}\n    style={{\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n      alignItems: 'center',\n    }}\n  >\n    {`${generator.type} generator`}\n    <div style={{\n      display: 'flex', flexDirection: 'row', flexWrap: 'wrap', marginBottom: '5px', \n    }}\n    >\n      {Array.from(Array(generator.energy)).map((_, i) => (\n        <EnergyBlock key={i} type={generator.type} style={{ margin: '1px' }} />\n      ))}\n    </div>\n  </div>\n);\n\nconst Consumer = ({ consumer, config }) => {\n  const byMix = {};\n  Object.entries(consumer.originMix).forEach(([generatorKey, v]) => {\n    const { type } = config.generators[generatorKey];\n    if (!byMix[type]) {\n      byMix[type] = 0;\n    }\n    byMix[type] += v;\n  });\n\n  return (\n    <>\n      <div>{`consumer ${consumer.key.slice(1)}`}</div>\n      <small>{consumer.hasResidualMix ? '(residual mix)' : null}</small>\n      <small>\n        {Object.entries(byMix)\n          .sort((a, b) => b[1] - a[1]) // desc\n          .map(([type, v]) => (\n            <div key={type} style={{ display: 'flex', alignItems: 'baseline' }}>\n              <EnergyBlock key={type} type={type} style={{ marginRight: '4px', width: v * 30 }} />\n              {`${type}: ${Math.round(v * 100)} %`}\n            </div>\n          ))}\n      </small>\n    </>\n  );\n};\n\nconst GridGenerators = ({ generators }) => {\n  const generatorArray = Object.values(generators);\n  return (\n    <div style={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-around' }}>\n      {Object.entries(generators).map(([generatorKey, generator], i) => {\n        const nextGenerator = generatorArray[i + 1];\n        const prevGenerator = generatorArray[i - 1];\n        const isConnectedToNext = generator.gridKey === nextGenerator?.gridKey;\n        const isConnectedToPrev = generator.gridKey === prevGenerator?.gridKey;\n        const extraStyles = {};\n        if (isConnectedToPrev || isConnectedToNext) {\n          extraStyles.borderBottom = '1px solid';\n          if (isConnectedToPrev && isConnectedToNext) {\n            extraStyles.borderColor = '#000';\n          } else {\n            extraStyles.borderImage = `linear-gradient(to ${\n              isConnectedToNext ? 'left' : 'right'\n            }, #000 50%, rgba(0, 0, 0, 0) 50%) 100% 1`;\n          }\n        }\n        return (\n          <div\n            key={generatorKey}\n            style={{\n              display: 'flex',\n              justifyContent: 'center',\n              flex: 1, // take equal horizontal space\n              ...extraStyles,\n            }}\n          >\n            <div\n              style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n                justifyContent: 'flex-end',\n              }}\n            >\n              <Generator key={generator.key} generator={generator} />\n              <div style={{ backgroundColor: '#000', height: 10, width: 1 }} />\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nconst GridConsumers = ({ config, configByGrid }) => {\n  const totalGenerators = Object.values(configByGrid).reduce(\n    (a, b) => Object.values(a.generators).length + Object.values(b.generators).length,\n  );\n  return (\n    <div style={{ display: 'flex', flexDirection: 'row', justifyContent: 'space-around' }}>\n      {Object.entries(configByGrid).map(([gridKey, gridConfig]) => {\n        const gridGenerators = Object.values(gridConfig.generators);\n        const gridConsumers = Object.values(gridConfig.consumers);\n        return (\n          <div\n            key={gridKey}\n            style={{\n              display: 'flex',\n              flex: 1, // take equal horizontal space\n              flexDirection: 'column',\n              alignItems: 'stretch', // children will take all horizontal space\n              flexBasis: `${(gridGenerators.length / totalGenerators) * 100}%`,\n            }}\n          >\n            <div\n              style={{\n                alignSelf: 'center',\n                backgroundColor: '#000',\n                height: GRID_CONNECTION_HEIGHT,\n                width: 1,\n              }}\n            />\n            <div\n              style={{\n                display: 'flex',\n                justifyContent: 'space-around',\n                flex: 1, // take equal horizontal space\n              }}\n            >\n              {gridConsumers.map((consumer, i) => {\n                const isConnectedToNext = gridConsumers[i + 1] != null;\n                const isConnectedToPrev = gridConsumers[i - 1] != null;\n                const extraStyles = {};\n                if (isConnectedToPrev || isConnectedToNext) {\n                  extraStyles.borderTop = '1px solid';\n                  if (isConnectedToPrev && isConnectedToNext) {\n                    extraStyles.borderColor = '#000';\n                  } else {\n                    extraStyles.borderImage = `linear-gradient(to ${\n                      isConnectedToNext ? 'left' : 'right'\n                    }, #000 50%, rgba(0, 0, 0, 0) 50%) 100% 1`;\n                  }\n                }\n                return (\n                  <div\n                    key={consumer.key}\n                    style={{\n                      display: 'flex',\n                      flexDirection: 'column',\n                      alignItems: 'center',\n                      justifyContent: 'flex-start',\n                      flex: 1, // take equal horizontal space\n                      ...extraStyles,\n                    }}\n                  >\n                    <div style={{ backgroundColor: '#000', height: 10, width: 1 }} />\n                    <Consumer consumer={consumer} config={config} />\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nconst AnnotationLayer = ({ config, configByGrid, attributionRule }) => {\n  const allGeneratorKeys = Object.keys(config.generators);\n  const allGridKeys = Object.keys(configByGrid);\n  // The following is the ratio occupied by each grid\n  const gridHorizontalRatios = Object.values(configByGrid).map(\n    grid => Object.keys(grid.generators).length / allGeneratorKeys.length,\n  );\n\n  const purchaseKeys = attributionRule === attributionRules.marketBased ? ['purchases'] : [];\n  const purchaseLabels = attributionRule === attributionRules.marketBased ? ['contract'] : [];\n\n  const purchaseLineSpecs = purchaseKeys\n    .map((k, i) => Object.values(config.consumers)\n      .filter(consumer => consumer[k]?.length)\n      .map(consumer => consumer[k].map(fromKey => [fromKey, consumer.key]))\n      .flat()\n      .map(([fromKey, toKey]) => {\n        const generatorInterval = 100 / allGeneratorKeys.length;\n        let x1 = 0.5 * generatorInterval + allGeneratorKeys.indexOf(fromKey) * generatorInterval;\n        const y1 = 18;\n\n        const consumerGridKey = config.consumers[toKey].gridKey;\n        const gridIndex = allGridKeys.indexOf(consumerGridKey);\n        const consumerKeysInGrid = Object.keys(configByGrid[consumerGridKey].consumers);\n        const indexWithinGrid = consumerKeysInGrid.indexOf(toKey);\n        const consumerInterval = (gridHorizontalRatios[gridIndex] / consumerKeysInGrid.length) * 100;\n        const consumerStart = gridHorizontalRatios.slice(0, gridIndex).reduce((a, b) => a + b, 0) * 100; // add the offset from potential previous grids\n        let x2 = consumerStart + consumerInterval * 0.5 + indexWithinGrid * consumerInterval;\n        const y2 = 50 + GRID_CONNECTION_HEIGHT / 10;\n\n        // Sugar\n        x1 += (x2 - x1 > 0 ? 1 : -1) * 3; // top (generator) x\n        if (Math.abs(x2 - x1) > 10) {\n          x2 += (x2 - x1 < -10 ? 1 : -1) * 3; // bottom (consumer) x\n        }\n\n        return {\n          x1, y1, x2, y2, fromKey, toKey, label: purchaseLabels[i], \n        };\n      }))\n    .flat();\n\n  return (\n    <svg\n      width=\"100%\"\n      height=\"100%\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      style={{\n        position: 'absolute',\n        height: '100%',\n        width: '100%',\n      }}\n    >\n      <defs>\n        <marker id=\"arrowhead\" markerWidth=\"10\" markerHeight=\"7\" refX=\"10\" refY=\"3.5\" orient=\"auto\">\n          <polygon points=\"0 0, 10 3.5, 0 7\" />\n        </marker>\n      </defs>\n      {purchaseLineSpecs.map(({\n        x1, y1, x2, y2, fromKey, toKey, label, \n      }) => (\n        <g key={label}>\n          <line\n            key={fromKey + toKey}\n            x1={`${x1}%`}\n            y1={`${y1}%`}\n            x2={`${x2}%`}\n            y2={`${y2}%`}\n            stroke=\"darkblue\"\n            strokeDasharray=\"4\"\n            markerEnd=\"url(#arrowhead)\"\n          />\n          <text\n            x={`${0.5 * (x1 + x2)}%`}\n            y={`${0.5 * (y1 + y2)}%`}\n            textAnchor=\"middle\"\n            style={{ stroke: 'white', strokeWidth: '0.6em' }}\n          >\n            {label}\n          </text>\n          <text x={`${0.5 * (x1 + x2)}%`} y={`${0.5 * (y1 + y2)}%`} textAnchor=\"middle\">\n            {label}\n          </text>\n        </g>\n      ))}\n    </svg>\n  );\n};\n\nexport default ({ config, attributionRuleKey, style }) => {\n  const buyer = 'c2';\n  const [seller, setSeller] = useState(config.consumers[buyer].purchases[0]);\n  const handleChangeSeller = (e) => {\n    setSeller(e.target.value);\n  };\n\n  // deep copy\n  const updatedConfig = JSON.parse(JSON.stringify(config));\n  updatedConfig.consumers = {\n    ...updatedConfig.consumers,\n    [buyer]: { ...updatedConfig.consumers[buyer], purchases: [seller] },\n  };\n\n  // Index\n  Object.keys(updatedConfig.generators).forEach((k) => {\n    updatedConfig.generators[k].key = k;\n  });\n  Object.entries(updatedConfig.consumers).forEach(([consumerKey, consumer]) => {\n    consumer.key = consumerKey;\n    ['purchases'].forEach((kk) => {\n      (consumer[kk] || []).forEach((generatorKey) => {\n        if (!updatedConfig.generators[generatorKey].purchasers) {\n          updatedConfig.generators[generatorKey].purchasers = [];\n        }\n        updatedConfig.generators[generatorKey].purchasers.push(consumerKey);\n      });\n    });\n  });\n\n  const attribute = attributionRules[attributionRuleKey];\n  const attributedConfig = attribute(updatedConfig);\n  const byGrid = configByGrid(attributedConfig);\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        flexDirection: 'column',\n        width: '90%',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n        ...style,\n      }}\n    >\n      <div style={{ position: 'relative' }}>\n        <AnnotationLayer\n          config={attributedConfig}\n          configByGrid={byGrid}\n          attributionRule={attribute}\n        />\n        <GridGenerators generators={attributedConfig.generators} />\n        <GridConsumers config={attributedConfig} configByGrid={byGrid} />\n      </div>\n      {attributionRuleKey === 'marketBased' ? (\n        <span>\n          <br />\n          &quot;consumer 2&quot; has a contract with the{' '}\n          <select onChange={handleChangeSeller}>\n            {Object.keys(config.generators)\n              .filter(k => !['coal'].includes(config.generators[k].type))\n              .map(k => (\n                <option key={k} value={k} selected={k === seller}>\n                  {config.generators[k].type}\n                </option>\n              ))}\n          </select>\n          {' generator'}\n        </span>\n      ) : null}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport Layout from '../components/layout';\nimport SEO from '../components/seo';\nimport Grid, { DEFAULT_CONFIG } from '../components/interactivegrid';\nimport { rhythm } from '../utils/typography';\n\nimport NorthVideo from '../videos/north.mp4';\n\nexport default ({ data, location }) => (\n  <Layout location={location}>\n    <SEO\n      title=\"Olivier Corradi | Projects\"\n    />\n\n    <h1 style={{ marginTop: rhythm(2) }}>Projects</h1>\n    This is a section containing projects I have worked on.\n\n    <h2 style={{ marginTop: rhythm(1) }}>Electricity Maps xbar plugin (2024)</h2>\n    <p>\n      A simple way to visualise how clean electricity is in your location.\n      Check out the blog post <a href=\"/blog/electricity-maps-macos-statusbar/\">here</a>.\n    </p>\n    <p>\n      <center>\n        <a href=\"https://polynomial.so\">\n          <img src=\"https://static.electricitymaps.com/xbar-screenshot.png\" alt=\"polynomial.so\" />\n        </a>\n      </center>\n    </p>\n\n    <h2 style={{ marginTop: rhythm(1) }}>Polynomial: A central place to track your most vital KPIs (2023)</h2>\n    <p>\n      Polynomial is the fastest way to centralize the performance indicators that matter to you.\n      Simply connect integrations, and Polynomial takes care of the rest.\n      Check it out <a href=\"https://polynomial.so\">here</a>, or contribute to it <a href=\"https://github.com/corradio/polynomial/\">here</a>.\n    </p>\n    <p>\n      <center>\n        <a href=\"https://polynomial.so\">\n          <img src=\"https://polynomial.so/static/images/social.png\" alt=\"polynomial.so\" />\n        </a>\n      </center>\n    </p>\n\n    <h2 style={{ marginTop: rhythm(1) }}>Scope 2 widget (2022)</h2>\n    It can be tricky to understand scope 2 carbon accounting rules.\n    A guide was written (<a href=\"https://www.electricitymaps.com/guides/accounting-guide\">Understanding Electricity Scope 2 Attribution Rules</a>), and a small widget was made as a complement.\n    Feel free to play around with it below:\n\n    <Grid config={DEFAULT_CONFIG} attributionRuleKey=\"marketBased\" style={{ padding: '2em' }} />\n\n    <h2 style={{ marginTop: rhythm(1) }}>footprintMap: CO₂ emissions of the global economy (2021)</h2>\n    <p>\n      footprintMap is a visualisation of the CO₂ emissions of the global economy.\n      It uses the electricityMap visualisation engine to\n      visualise various indicators about the global econonomy: GDP, population, emissions and energy supply.\n      Check it out <a href=\"https://footprintmap.org\">here</a>, or contribute to it <a href=\"https://github.com/corradio/footprintmap/\">here</a>.\n    </p>\n    <p>\n      <center>\n        <a href=\"https://footprintmap.org\">\n          <img src=\"https://footprintmap.org/images/social_image.png\" alt=\"footprintmap.org\" />\n        </a>\n      </center>\n    </p>\n\n    <h2 style={{ marginTop: rhythm(2) }}>The North app: automating your personal carbon footprint (2019-2020)</h2>\n    <p>\n      With the team at Tomorrow, we worked on the North app, which was envisioned as a way to automatically track and calculate the carbon footprint of your life.\n      It worked by connecting to apps you already used in order to track the activities you perform in your daily life.\n      For example, by connecting and parsing your emails, the app was able to detect all plane and train tickets purchased.\n      By connecting to your bank, the app was able to assess all items purchased (e.g. groceries or clothing).\n      Finally, by connecting to your smart meter or electric vehicle, the app was able to assess the time at which you used electricity.\n    </p>\n    <p>\n      As the app had access to a significant amount of sensitive content, it was <i>private by design</i>:\n      all data processing was done on the phone, and it didn&apos;t upload any information onto our servers.\n    </p>\n    <p>\n      All the carbon models and the integrations were <a href=\"https://github.com/tmrowco/northapp-contrib\">open-sourced</a> in order to create a community helping us to cover the whole ecosystem of potential integrations, and to enable trust in the carbon models.\n    </p>\n    <p>\n      North was discontinued in August 2020 (read more <a href=\"https://www.tmrow.com/blog/sunsetting-north/\">here</a>).\n    </p>\n    <p>\n      <center>\n        <video width=\"250\" height=\"445\" controls>\n          <source src={NorthVideo} type=\"video/mp4\" />\n        </video>\n      </center>\n    </p>\n\n    <h2 style={{ marginTop: rhythm(2) }}>brick: a build tool for mono-repositories (2019-2020)</h2>\n    <p>\n      Larger organisations such as Google, Facebook and Twitter have adopted the mono-repository approach as they have the means to maintain such an infrastructure,\n      but unfortunately solutions for smaller organisations are limited.\n      At electricityMap, we wanted to embrace the mono-repository structure.\n      brick was therefore built as a simple build tool for mono-repositories.\n      Read more about it <a href=\"https://electricitymap.org/blog/brick-a-build-tool-for-mono-repositories/\">here</a> and contribute to it <a href=\"https://github.com/electricitymap/brick\">here</a>.\n    </p>\n\n  </Layout>\n);\n","'use strict';\nvar UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","'use strict';\nvar internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.es/ecma262/#sec-isarray\n// eslint-disable-next-line es/no-array-isarray -- safe\nmodule.exports = Array.isArray || function isArray(argument) {\n  return classof(argument) == 'Array';\n};\n","module.exports = __webpack_public_path__ + \"static/north-0a9b426f5479022f62cc60e43d7a2272.mp4\";","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar isCallable = require('../internals/is-callable');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this-clause');\nvar aCallable = require('../internals/a-callable');\nvar NATIVE_BIND = require('../internals/function-bind-native');\n\nvar bind = uncurryThis(uncurryThis.bind);\n\n// optional / simple context binding\nmodule.exports = function (fn, that) {\n  aCallable(fn);\n  return that === undefined ? fn : NATIVE_BIND ? bind(fn, that) : function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toIntegerOrInfinity = require('../internals/to-integer-or-infinity');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flat` method\n// https://tc39.es/ecma262/#sec-array.prototype.flat\n$({ target: 'Array', proto: true }, {\n  flat: function flat(/* depthArg = 1 */) {\n    var depthArg = arguments.length ? arguments[0] : undefined;\n    var O = toObject(this);\n    var sourceLen = lengthOfArrayLike(O);\n    var A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, depthArg === undefined ? 1 : toIntegerOrInfinity(depthArg));\n    return A;\n  }\n});\n","'use strict';\nvar userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar isConstructor = require('../internals/is-constructor');\nvar isObject = require('../internals/is-object');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\nvar $Array = Array;\n\n// a part of `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (isConstructor(C) && (C === $Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? $Array : C;\n};\n","'use strict';\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n","'use strict';\nvar getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar V8_PROTOTYPE_DEFINE_BUG = require('../internals/v8-prototype-define-bug');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.es/ecma262/#sec-object.defineproperties\n// eslint-disable-next-line es/no-object-defineproperties -- safe\nexports.f = DESCRIPTORS && !V8_PROTOTYPE_DEFINE_BUG ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var props = toIndexedObject(Properties);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], props[key]);\n  return O;\n};\n","'use strict';\nvar $TypeError = TypeError;\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF; // 2 ** 53 - 1 == 9007199254740991\n\nmodule.exports = function (it) {\n  if (it > MAX_SAFE_INTEGER) throw $TypeError('Maximum allowed index exceeded');\n  return it;\n};\n","'use strict';\n// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('flat');\n","'use strict';\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  defineProperty(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","'use strict';\nvar classofRaw = require('../internals/classof-raw');\nvar uncurryThis = require('../internals/function-uncurry-this');\n\nmodule.exports = function (fn) {\n  // Nashorn bug:\n  //   https://github.com/zloirock/core-js/issues/1128\n  //   https://github.com/zloirock/core-js/issues/1130\n  if (classofRaw(fn) === 'Function') return uncurryThis(fn);\n};\n","'use strict';\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\n\nvar $Array = Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = $Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar deletePropertyOrThrow = require('../internals/delete-property-or-throw');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar nativeSort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort(array) : nativeSort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = lengthOfArrayLike(items);\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) deletePropertyOrThrow(array, index++);\n\n    return array;\n  }\n});\n","'use strict';\nvar userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","'use strict';\nvar classof = require('../internals/classof');\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n","'use strict';\nvar arraySpeciesConstructor = require('../internals/array-species-constructor');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.es/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);\n};\n","'use strict';\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar fails = require('../internals/fails');\nvar isCallable = require('../internals/is-callable');\nvar classof = require('../internals/classof');\nvar getBuiltIn = require('../internals/get-built-in');\nvar inspectSource = require('../internals/inspect-source');\n\nvar noop = function () { /* empty */ };\nvar empty = [];\nvar construct = getBuiltIn('Reflect', 'construct');\nvar constructorRegExp = /^\\s*(?:class|function)\\b/;\nvar exec = uncurryThis(constructorRegExp.exec);\nvar INCORRECT_TO_STRING = !constructorRegExp.exec(noop);\n\nvar isConstructorModern = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  try {\n    construct(noop, empty, argument);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nvar isConstructorLegacy = function isConstructor(argument) {\n  if (!isCallable(argument)) return false;\n  switch (classof(argument)) {\n    case 'AsyncFunction':\n    case 'GeneratorFunction':\n    case 'AsyncGeneratorFunction': return false;\n  }\n  try {\n    // we can't check .prototype since constructors produced by .bind haven't it\n    // `Function#toString` throws on some built-it function in some legacy engines\n    // (for example, `DOMQuad` and similar in FF41-)\n    return INCORRECT_TO_STRING || !!exec(constructorRegExp, inspectSource(argument));\n  } catch (error) {\n    return true;\n  }\n};\n\nisConstructorLegacy.sham = true;\n\n// `IsConstructor` abstract operation\n// https://tc39.es/ecma262/#sec-isconstructor\nmodule.exports = !construct || fails(function () {\n  var called;\n  return isConstructorModern(isConstructorModern.call)\n    || !isConstructorModern(Object)\n    || !isConstructorModern(function () { called = true; })\n    || called;\n}) ? isConstructorLegacy : isConstructorModern;\n","'use strict';\n/* global ActiveXObject -- old IE, WSH */\nvar anObject = require('../internals/an-object');\nvar definePropertiesModule = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    activeXDocument = new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = typeof document != 'undefined'\n    ? document.domain && activeXDocument\n      ? NullProtoObjectViaActiveX(activeXDocument) // old IE\n      : NullProtoObjectViaIFrame()\n    : NullProtoObjectViaActiveX(activeXDocument); // WSH\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.es/ecma262/#sec-object.create\n// eslint-disable-next-line es/no-object-create -- safe\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : definePropertiesModule.f(result, Properties);\n};\n","'use strict';\nvar toPropertyKey = require('../internals/to-property-key');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","'use strict';\nvar isArray = require('../internals/is-array');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar doesNotExceedSafeInteger = require('../internals/does-not-exceed-safe-integer');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg) : false;\n  var element, elementLen;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        elementLen = lengthOfArrayLike(element);\n        targetIndex = flattenIntoArray(target, original, element, elementLen, targetIndex, depth - 1) - 1;\n      } else {\n        doesNotExceedSafeInteger(targetIndex + 1);\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","'use strict';\nvar arraySlice = require('../internals/array-slice-simple');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n"],"sourceRoot":""}